<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Varia√ß√£o de √Çngulo - Integral de Linha</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            background: linear-gradient(135deg, #0f172a, #1e293b, #334155);
            color: white;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 20px;
            align-items: start;
        }
        
        .simulation-area {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .controls-panel {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            height: fit-content;
        }
        
        .control-group {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .control-group:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .control-group h3 {
            margin: 0 0 15px 0;
            color: #60a5fa;
            font-size: 16px;
        }
        
        .control-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .control-item:last-child {
            margin-bottom: 0;
        }
        
        label {
            font-size: 14px;
            font-weight: 500;
            color: #e2e8f0;
        }
        
        select, input[type="range"] {
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255,255,255,0.15);
            color: white;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        select option {
            background: #2a5298;
            color: white;
        }
        
        input[type="range"] {
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.2);
            outline: none;
            border-radius: 3px;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            background: #60a5fa;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        
        .value-display {
            font-size: 12px;
            color: #cbd5e1;
            background: rgba(0,0,0,0.3);
            padding: 6px 10px;
            border-radius: 6px;
            text-align: center;
            font-family: 'Courier New', monospace;
        }
        
        .button {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border: none;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            width: 100%;
            margin: 5px 0;
        }
        
        .button:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        .button.reset {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        .button.reset:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
        }
        
        .data-display {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.6;
        }
        
        .formula-box {
            background: rgba(0,0,0,0.4);
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            border-left: 4px solid #60a5fa;
            margin: 10px 0;
        }
        
        .legend {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }
        
        .legend-color {
            width: 16px;
            height: 3px;
            border-radius: 2px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
        }
        
        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #60a5fa;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìê Varia√ß√£o de √Çngulo em Curvas</h1>
            <p>Visualiza√ß√£o da integral ‚à´‚ü®u'(t), u‚ä•(t)‚ü©dt para medir varia√ß√£o angular</p>
        </div>
        
        <div class="main-content">
            <div class="simulation-area">
                <div id="canvas-container"></div>
            </div>
            
            <div class="controls-panel">
                <div class="control-group">
                    <h3>üìà Tipo de Curva</h3>
                    
                    <div class="control-item">
                        <label for="curve-select">Curva c(t):</label>
                        <select id="curve-select">
                            <option value="ellipse">Elipse</option>
                            <option value="spiral">Espiral</option>
                            <option value="heart">Cardioide</option>
                            <option value="lemniscate">Lemniscata</option>
                            <option value="rose">Rosa</option>
                            <option value="tikz">Curva TikZ</option>
                        </select>
                    </div>
                    
                    <div class="control-item">
                        <label for="scale-slider">Escala da Curva:</label>
                        <input type="range" id="scale-slider" min="0.5" max="3" step="0.1" value="1.5">
                        <div class="value-display" id="scale-display">1.5</div>
                    </div>
                    
                    <div class="control-item">
                        <label for="offset-x-slider">Deslocamento X:</label>
                        <input type="range" id="offset-x-slider" min="-200" max="200" step="10" value="0">
                        <div class="value-display" id="offset-x-display">0</div>
                    </div>
                    
                    <div class="control-item">
                        <label for="offset-y-slider">Deslocamento Y:</label>
                        <input type="range" id="offset-y-slider" min="-200" max="200" step="10" value="0">
                        <div class="value-display" id="offset-y-display">0</div>
                    </div>
                </div>
                
                <div class="control-group">
                    <h3>‚öôÔ∏è Par√¢metros</h3>
                    
                    <div class="control-item">
                        <label for="t-slider">Par√¢metro t:</label>
                        <input type="range" id="t-slider" min="0" max="6.28" step="0.01" value="0">
                        <div class="value-display" id="t-display">0.00</div>
                    </div>
                    
                    <div class="control-item">
                        <label for="speed-slider">Velocidade:</label>
                        <input type="range" id="speed-slider" min="0" max="0.05" step="0.005" value="0.02">
                        <div class="value-display" id="speed-display">0.02</div>
                    </div>
                </div>
                
                <div class="control-group">
                    <h3>üéÆ Controles</h3>
                    <button class="button" id="play-btn">‚ñ∂Ô∏è Animar</button>
                    <button class="button" id="pause-btn">‚è∏Ô∏è Pausar</button>
                    <button class="button reset" id="reset-btn">üîÑ Reiniciar</button>
                </div>
                
                <div class="control-group">
                    <h3>üëÅÔ∏è Visualiza√ß√£o</h3>
                    
                    <div class="checkbox-item">
                        <input type="checkbox" id="show-circle" checked>
                        <label for="show-circle">Mostrar Circunfer√™ncia</label>
                    </div>
                    
                    <div class="checkbox-item">
                        <input type="checkbox" id="show-vectors" checked>
                        <label for="show-vectors">Mostrar Vetores u(t) e u‚ä•(t)</label>
                    </div>
                    
                    <div class="checkbox-item">
                        <input type="checkbox" id="show-trail" checked>
                        <label for="show-trail">Mostrar Rastro</label>
                    </div>
                    
                    <div class="checkbox-item">
                        <input type="checkbox" id="show-derivative" checked>
                        <label for="show-derivative">Mostrar u'(t)</label>
                    </div>
                    
                    <div class="checkbox-item">
                        <input type="checkbox" id="show-radial" checked>
                        <label for="show-radial">Mostrar Linha Radial</label>
                    </div>
                </div>
                
                <div class="control-group">
                    <h3>üìä Dados Atuais</h3>
                    <div class="data-display" id="data-display">
                        t = 0.00<br>
                        c(t) = (0.0, 0.0)<br>
                        ||c(t)|| = 0.00<br>
                        u(t) = (0.0, 0.0)<br>
                        ‚ü®u'(t), u‚ä•(t)‚ü© = 0.00
                    </div>
                </div>
                
                <div class="control-group">
                    <h3>‚à´ Varia√ß√£o Angular</h3>
                    <div class="formula-box" id="angle-display">
                        ‚à´‚ü®u'(t), u‚ä•(t)‚ü©dt = 0.00 rad<br>
                        = 0.0¬∞
                    </div>
                </div>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #60a5fa;"></div>
                        <span>Curva c(t)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #10b981;"></div>
                        <span>Vetor u(t)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f59e0b;"></div>
                        <span>Vetor u‚ä•(t)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ef4444;"></div>
                        <span>Derivada u'(t)</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simulation variables
        let centerX, centerY;
        let currentT = 0;
        let isAnimating = false;
        let animationSpeed = 0.02;
        let curveScale = 1.5;
        let selectedCurve = 'ellipse';
        let offsetX = 0;
        let offsetY = 0;
        
        // Visual options
        let showCircle = true;
        let showVectors = true;
        let showTrail = true;
        let showDerivative = true;
        let showRadial = true;
        
        // Trail and angle accumulation
        let trail = [];
        let angleVariation = 0;
        let lastU = null;
        
        // TikZ curve parameters
        const tikzParams = {
            a: 4.3,
            b: 1.8,
            c: -3.88,
            d: -3.81,
            s: 3,
            xshift: 1.5
        };
        
        // Curve definitions
        const curves = {
            ellipse: {
                name: 'Elipse',
                x: (t, scale) => scale * 80 * Math.cos(t),
                y: (t, scale) => scale * 50 * Math.sin(t),
                dx: (t, scale) => -scale * 80 * Math.sin(t),
                dy: (t, scale) => scale * 50 * Math.cos(t)
            },
            spiral: {
                name: 'Espiral',
                x: (t, scale) => scale * (20 + t * 8) * Math.cos(t),
                y: (t, scale) => scale * (20 + t * 8) * Math.sin(t),
                dx: (t, scale) => scale * (8 * Math.cos(t) - (20 + t * 8) * Math.sin(t)),
                dy: (t, scale) => scale * (8 * Math.sin(t) + (20 + t * 8) * Math.cos(t))
            },
            heart: {
                name: 'Cardioide',
                x: (t, scale) => scale * 40 * (2 * Math.cos(t) - Math.cos(2 * t)),
                y: (t, scale) => scale * 40 * (2 * Math.sin(t) - Math.sin(2 * t)),
                dx: (t, scale) => scale * 40 * (-2 * Math.sin(t) + 2 * Math.sin(2 * t)),
                dy: (t, scale) => scale * 40 * (2 * Math.cos(t) - 2 * Math.cos(2 * t))
            },
            lemniscate: {
                name: 'Lemniscata',
                x: (t, scale) => scale * 60 * Math.cos(t) / (1 + Math.sin(t) * Math.sin(t)),
                y: (t, scale) => scale * 60 * Math.sin(t) * Math.cos(t) / (1 + Math.sin(t) * Math.sin(t)),
                dx: (t, scale) => {
                    let sin_t = Math.sin(t);
                    let cos_t = Math.cos(t);
                    let denom = 1 + sin_t * sin_t;
                    return scale * 60 * ((-sin_t * denom - cos_t * 2 * sin_t * cos_t) / (denom * denom));
                },
                dy: (t, scale) => {
                    let sin_t = Math.sin(t);
                    let cos_t = Math.cos(t);
                    let denom = 1 + sin_t * sin_t;
                    return scale * 60 * (((cos_t * cos_t - sin_t * sin_t) * denom - sin_t * cos_t * 2 * sin_t * cos_t) / (denom * denom));
                }
            },
            rose: {
                name: 'Rosa',
                x: (t, scale) => scale * 60 * Math.cos(3 * t) * Math.cos(t),
                y: (t, scale) => scale * 60 * Math.cos(3 * t) * Math.sin(t),
                dx: (t, scale) => scale * 60 * (-3 * Math.sin(3 * t) * Math.cos(t) - Math.cos(3 * t) * Math.sin(t)),
                dy: (t, scale) => scale * 60 * (-3 * Math.sin(3 * t) * Math.sin(t) + Math.cos(3 * t) * Math.cos(t))
            },
            tikz: {
                name: 'Curva TikZ',
                x: (t, scale) => {
                    return scale * 40 * ((tikzParams.a * Math.cos(t) + tikzParams.b * Math.sin(tikzParams.c * t)) / tikzParams.s + tikzParams.xshift);
                },
                y: (t, scale) => {
                    return scale * 40 * ((tikzParams.a * Math.sin(t) + tikzParams.b * Math.cos(tikzParams.d * t)) / tikzParams.s);
                },
                dx: (t, scale) => {
                    return scale * 40 * ((-tikzParams.a * Math.sin(t) + tikzParams.b * tikzParams.c * Math.cos(tikzParams.c * t)) / tikzParams.s);
                },
                dy: (t, scale) => {
                    return scale * 40 * ((tikzParams.a * Math.cos(t) - tikzParams.b * tikzParams.d * Math.sin(tikzParams.d * t)) / tikzParams.s);
                }
            }
        };
        
        function setup() {
            let canvas = createCanvas(900, 700);
            canvas.parent('canvas-container');
            
            centerX = width / 2;
            centerY = height / 2;
            
            setupControls();
        }
        
        function draw() {
            // Clear background
            background(30, 41, 59);
            
            // Draw grid
            drawGrid();
            
            // Draw complete curve
            drawCompleteCurve();
            
            // Draw circle if enabled
            if (showCircle) {
                drawUnitCircle();
            }
            
            // Calculate current point and vectors
            let currentPoint = getCurrentPoint();
            let vectors = calculateVectors(currentPoint);
            
            // Draw radial line if enabled
            if (showRadial) {
                drawRadialLine(currentPoint);
            }
            
            // Draw trail
            if (showTrail) {
                drawTrail();
            }
            
            // Draw vectors
            if (showVectors) {
                drawVectors(currentPoint, vectors);
            }
            
            // Draw current point
            drawCurrentPoint(currentPoint);
            
            // Update displays
            updateDataDisplay(currentPoint, vectors);
            
            // Animation
            if (isAnimating) {
                currentT += animationSpeed;
                if (currentT > 2 * Math.PI) {
                    currentT = 0;
                    resetAccumulation();
                }
                document.getElementById('t-slider').value = currentT;
                document.getElementById('t-display').textContent = currentT.toFixed(2);
            }
        }
        
        function drawGrid() {
            stroke(255, 255, 255, 30);
            strokeWeight(1);
            
            // Vertical lines
            for (let x = 0; x <= width; x += 40) {
                line(x, 0, x, height);
            }
            
            // Horizontal lines
            for (let y = 0; y <= height; y += 40) {
                line(0, y, width, y);
            }
            
            // Main axes
            stroke(255, 255, 255, 80);
            strokeWeight(2);
            line(0, centerY, width, centerY); // x-axis
            line(centerX, 0, centerX, height); // y-axis
        }
        
        function drawCompleteCurve() {
            let curve = curves[selectedCurve];
            
            stroke(96, 165, 250);
            strokeWeight(3);
            noFill();
            
            beginShape();
            for (let t = 0; t <= 2 * Math.PI; t += 0.02) {
                let x = centerX + curve.x(t, curveScale) + offsetX;
                let y = centerY - curve.y(t, curveScale) + offsetY; // Flip Y for screen coordinates
                vertex(x, y);
            }
            endShape();
        }
        
        function drawUnitCircle() {
            // Fixed unit circle with radius 80 pixels
            stroke(255, 255, 255, 150);
            strokeWeight(2);
            noFill();
            ellipse(centerX, centerY, 160, 160); // diameter = 160, radius = 80
        }
        
        function drawRadialLine(point) {
            stroke(255, 255, 255, 120);
            strokeWeight(1);
            setLineDash([5, 5]);
            line(centerX, centerY, centerX + point.x + offsetX, centerY - point.y + offsetY);
            setLineDash([]);
        }
        
        function setLineDash(pattern) {
            drawingContext.setLineDash(pattern);
        }
        
        function getCurrentPoint() {
            let curve = curves[selectedCurve];
            return {
                x: curve.x(currentT, curveScale),
                y: curve.y(currentT, curveScale),
                dx: curve.dx(currentT, curveScale),
                dy: curve.dy(currentT, curveScale)
            };
        }
        
        function calculateVectors(point) {
            // Calculate ||c(t)||
            let norm = Math.sqrt(point.x * point.x + point.y * point.y);
            
            if (norm === 0) {
                return {
                    u: { x: 0, y: 0 },
                    uPerp: { x: 0, y: 0 },
                    uDot: { x: 0, y: 0 },
                    dotProduct: 0,
                    norm: 0
                };
            }
            
            // Unit vector u(t) = c(t) / ||c(t)||
            let u = {
                x: point.x / norm,
                y: point.y / norm
            };
            
            // Perpendicular vector u‚ä•(t) - oriented 90¬∞ counterclockwise from u(t)
            let uPerp = {
                x: -u.y,  // 90¬∞ counterclockwise rotation
                y: u.x
            };
            
            // Calculate u'(t) using the derivative formula
            let dotProduct = point.x * point.dx + point.y * point.dy;
            
            let uDot = {
                x: (point.dx * norm - point.x * dotProduct / norm) / (norm * norm),
                y: (point.dy * norm - point.y * dotProduct / norm) / (norm * norm)
            };
            
            // Calculate ‚ü®u'(t), u‚ä•(t)‚ü© - this gives the angular velocity
            // Positive when rotating counterclockwise, negative when clockwise
            let dotProductFinal = uDot.x * uPerp.x + uDot.y * uPerp.y;
            
            // Accumulate angle variation - correct sign convention
            if (lastU !== null && isAnimating) {
                angleVariation += dotProductFinal * animationSpeed;
            }
            lastU = u;
            
            return {
                u: u,
                uPerp: uPerp,
                uDot: uDot,
                dotProduct: dotProductFinal,
                norm: norm
            };
        }
        
        function drawVectors(point, vectors) {
            let screenX = centerX + point.x + offsetX;
            let screenY = centerY - point.y + offsetY;
            
            // Calculate position on unit circle for u(t)
            let unitRadius = 80; // Fixed unit circle radius
            let unitX = centerX + vectors.u.x * unitRadius;
            let unitY = centerY - vectors.u.y * unitRadius;
            
            // Draw u(t) - green (radial vector on unit circle)
            stroke(16, 185, 129);
            strokeWeight(3);
            line(centerX, centerY, unitX, unitY);
            drawArrow(unitX, unitY, vectors.u.x, -vectors.u.y, color(16, 185, 129));
            
            // Draw u‚ä•(t) - orange (perpendicular vector starting from end of u(t))
            let perpScale = 50; // Fixed length for perpendicular vector
            let perpEndX = unitX + vectors.uPerp.x * perpScale;
            let perpEndY = unitY - vectors.uPerp.y * perpScale;
            
            stroke(245, 158, 11);
            strokeWeight(3);
            line(unitX, unitY, perpEndX, perpEndY);
            drawArrow(perpEndX, perpEndY, vectors.uPerp.x, -vectors.uPerp.y, color(245, 158, 11));
            
            // Draw u'(t) - red (if enabled) - starting from unit circle position
            if (showDerivative) {
                let derivativeScale = 200; // Scale for visibility
                stroke(239, 68, 68);
                strokeWeight(2);
                line(unitX, unitY, 
                     unitX + vectors.uDot.x * derivativeScale, 
                     unitY - vectors.uDot.y * derivativeScale);
                drawArrow(unitX + vectors.uDot.x * derivativeScale, 
                         unitY - vectors.uDot.y * derivativeScale, 
                         vectors.uDot.x, -vectors.uDot.y, color(239, 68, 68));
            }
            
            // Vector labels
            fill(255);
            noStroke();
            textAlign(CENTER);
            textSize(12);
            text('u(t)', unitX + vectors.u.x * 15, unitY - vectors.u.y * 15 - 5);
            text('u‚ä•(t)', perpEndX + 10, perpEndY - 5);
            
            if (showDerivative) {
                text("u'(t)", unitX + vectors.uDot.x * 200 + 15, 
                     unitY - vectors.uDot.y * 200 - 5);
            }
            
            // Show direction of rotation with color coding
            let rotationColor = vectors.dotProduct > 0 ? 
                color(0, 255, 0, 100) : color(255, 0, 0, 100); // Green for CCW, Red for CW
            
            fill(rotationColor);
            noStroke();
            ellipse(unitX, unitY, 20);
        }
        
        function drawArrow(x, y, dirX, dirY, col) {
            push();
            translate(x, y);
            rotate(atan2(-dirY, dirX));
            
            fill(col);
            noStroke();
            triangle(0, 0, -10, -4, -10, 4);
            
            pop();
        }
        
        function drawTrail() {
            if (trail.length > 1) {
                stroke(96, 165, 250, 150);
                strokeWeight(2);
                noFill();
                
                beginShape();
                for (let point of trail) {
                    vertex(centerX + point.x + offsetX, centerY - point.y + offsetY);
                }
                endShape();
            }
            
            // Add current point to trail
            if (frameCount % 3 === 0) {
                let currentPoint = getCurrentPoint();
                trail.push({ x: currentPoint.x, y: currentPoint.y });
                
                if (trail.length > 200) {
                    trail.shift();
                }
            }
        }
        
        function drawCurrentPoint(point) {
            let screenX = centerX + point.x + offsetX;
            let screenY = centerY - point.y + offsetY;
            
            // Point on curve
            fill(255, 255, 100);
            stroke(255);
            strokeWeight(2);
            ellipse(screenX, screenY, 12);
            
            // Point on unit circle (showing u(t) position)
            let norm = Math.sqrt(point.x * point.x + point.y * point.y);
            if (norm > 0) {
                let unitRadius = 80; // Fixed unit circle radius
                let unitX = centerX + (point.x / norm) * unitRadius;
                let unitY = centerY - (point.y / norm) * unitRadius;
                
                fill(16, 185, 129);
                stroke(255);
                strokeWeight(2);
                ellipse(unitX, unitY, 10);
            }
        }
        
        function updateDataDisplay(point, vectors) {
            let dataDisplay = document.getElementById('data-display');
            let rotationDirection = vectors.dotProduct > 0 ? "‚Ü∫ Anti-hor√°rio" : "‚Üª Hor√°rio";
            let rotationColor = vectors.dotProduct > 0 ? "color: #00ff00;" : "color: #ff6666;";
            
            dataDisplay.innerHTML = `
                t = ${currentT.toFixed(2)}<br>
                c(t) = (${point.x.toFixed(1)}, ${point.y.toFixed(1)})<br>
                ||c(t)|| = ${vectors.norm.toFixed(2)}<br>
                u(t) = (${vectors.u.x.toFixed(3)}, ${vectors.u.y.toFixed(3)})<br>
                ‚ü®u'(t), u‚ä•(t)‚ü© = ${vectors.dotProduct.toFixed(4)}<br>
                <span style="${rotationColor}">Rota√ß√£o: ${rotationDirection}</span>
            `;
            
            let angleDisplay = document.getElementById('angle-display');
            let degrees = (angleVariation * 180 / Math.PI).toFixed(1);
            angleDisplay.innerHTML = `
                ‚à´‚ü®u'(t), u‚ä•(t)‚ü©dt = ${angleVariation.toFixed(3)} rad<br>
                = ${degrees}¬∞<br>
                <small>+ Anti-hor√°rio | - Hor√°rio</small>
            `;
        }
        
        function resetAccumulation() {
            angleVariation = 0;
            lastU = null;
            trail = [];
        }
        
        function setupControls() {
            // Curve selector
            document.getElementById('curve-select').addEventListener('change', (e) => {
                selectedCurve = e.target.value;
                resetAccumulation();
            });
            
            // Scale slider
            document.getElementById('scale-slider').addEventListener('input', (e) => {
                curveScale = parseFloat(e.target.value);
                document.getElementById('scale-display').textContent = curveScale.toFixed(1);
                resetAccumulation();
            });
            
            // Offset sliders
            document.getElementById('offset-x-slider').addEventListener('input', (e) => {
                offsetX = parseInt(e.target.value);
                document.getElementById('offset-x-display').textContent = offsetX;
                resetAccumulation();
            });
            
            document.getElementById('offset-y-slider').addEventListener('input', (e) => {
                offsetY = parseInt(e.target.value);
                document.getElementById('offset-y-display').textContent = offsetY;
                resetAccumulation();
            });
            
            // t parameter slider
            document.getElementById('t-slider').addEventListener('input', (e) => {
                currentT = parseFloat(e.target.value);
                document.getElementById('t-display').textContent = currentT.toFixed(2);
                if (!isAnimating) resetAccumulation();
            });
            
            // Speed slider
            document.getElementById('speed-slider').addEventListener('input', (e) => {
                animationSpeed = parseFloat(e.target.value);
                document.getElementById('speed-display').textContent = animationSpeed.toFixed(3);
            });
            
            // Control buttons
            document.getElementById('play-btn').addEventListener('click', () => {
                isAnimating = true;
            });
            
            document.getElementById('pause-btn').addEventListener('click', () => {
                isAnimating = false;
            });
            
            document.getElementById('reset-btn').addEventListener('click', () => {
                currentT = 0;
                document.getElementById('t-slider').value = 0;
                document.getElementById('t-display').textContent = '0.00';
                resetAccumulation();
            });
            
            // Visual checkboxes
            document.getElementById('show-circle').addEventListener('change', (e) => {
                showCircle = e.target.checked;
            });
            
            document.getElementById('show-vectors').addEventListener('change', (e) => {
                showVectors = e.target.checked;
            });
            
            document.getElementById('show-trail').addEventListener('change', (e) => {
                showTrail = e.target.checked;
            });
            
            document.getElementById('show-derivative').addEventListener('change', (e) => {
                showDerivative = e.target.checked;
            });
            
            document.getElementById('show-radial').addEventListener('change', (e) => {
                showRadial = e.target.checked;
            });
        }
    </script>
</body>
</html>